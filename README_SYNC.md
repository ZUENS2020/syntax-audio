# Syntax Audio - 共享工作空间音乐播放器

这是一个支持多用户共享工作空间的音乐播放器，所有用户可以共同维护音乐库和工作空间。

## 功能特性

- **共享工作空间**: 所有用户共享一套工作空间，可以创建、编辑和删除工作空间
- **云端音乐存储**: 用户上传的音乐自动存储到云端，所有用户都能访问
- **实时同步**: 工作空间和音乐列表实时同步到所有连接的用户
- **独立播放控制**: 每个用户的播放控制相互独立，不同步播放状态
- **流媒体播放**: 支持流式播放云端音乐文件

## 技术栈

- **后端**: Node.js + Express + Socket.IO + Multer
- **前端**: React + TypeScript + Vite + Socket.IO Client

## 核心概念

### 工作空间 (Workspace)
- 所有用户共享的工作空间集合
- 每个工作空间包含独立的播放列表
- 支持创建、切换、重命名、删除工作空间

### 音乐文件
- 上传到服务器后，所有用户都能访问
- 按工作空间组织，每首歌属于特定工作空间
- 支持流媒体播放，无需下载整个文件

## API 端点

- `GET /workspaces`: 获取所有工作空间列表
- `GET /songs`: 获取所有歌曲列表
- `GET /workspaces/:workspaceId/songs`: 获取特定工作空间的歌曲
- `POST /upload`: 上传歌曲文件（需要指定workspaceId）
- `GET /stream/:songId`: 流媒体播放歌曲

## Socket.IO 事件

### 服务器到客户端
- `workspaces`: 发送工作空间列表
- `songs`: 发送歌曲列表
- `workspace-created`: 新工作空间创建通知
- `workspace-updated`: 工作空间更新通知
- `workspace-deleted`: 工作空间删除通知
- `song-uploaded`: 新歌曲上传通知

### 客户端到服务器
- `create-workspace`: 创建新工作空间
- `update-workspace`: 更新工作空间
- `delete-workspace`: 删除工作空间

## 使用说明

1. **启动服务**:
   ```bash
   # 构建前后端
   npm run build:all
   
   # 启动后端
   npm run start:server
   
   # 启动前端（新终端）
   npm run dev
   ```

2. **使用流程**:
   - 打开多个浏览器标签页连接到应用
   - 所有用户都能看到相同的工作空间列表
   - 上传音乐时选择目标工作空间
   - 音乐会自动同步到所有用户的对应工作空间
   - 每个用户的播放控制独立，不影响其他用户

3. **工作空间管理**:
   - 创建新工作空间：所有用户都能看到新工作空间
   - 切换工作空间：只影响当前用户的播放列表
   - 删除工作空间：从所有用户的列表中移除

## 架构特点

- **无状态播放**: 每个用户的播放状态完全独立
- **共享数据**: 工作空间和音乐文件在所有用户间共享
- **实时同步**: 使用WebSocket实时同步数据变更
- **流媒体**: 支持大文件流式播放，无需完整下载